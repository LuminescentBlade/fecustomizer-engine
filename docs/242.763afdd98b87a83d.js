"use strict";(self.webpackChunkkamui_customizer=self.webpackChunkkamui_customizer||[]).push([[242],{6838:($,L,x)=>{x.d(L,{I:()=>h});var e=x(4755),E=x(9523);let h=(()=>{class T{constructor(v){this._baseHref=v}getBasePath(v){return[".",this._baseHref.split("/").join(""),v].filter(s=>s.length).join("/")}}return T.\u0275fac=function(v){return new(v||T)(E.LFG(e.mr))},T.\u0275prov=E.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},872:($,L,x)=>{x.d(L,{J:()=>z});var e=x(9523);function E(i,C){return i+Math.floor((C-i+1)*Math.random())}var h=x(4755);const T=["*"];let m=(()=>{class i{constructor(){this.baseClass=!0,this.disabled=!1,this.enableMenu=!1,this.valueChange=new e.vpe}ngOnInit(){}next(){let t=this.value+1;t>this.max&&(t=this.min),this.valueChange.emit(t)}previous(){let t=this.value-1;t<this.min&&(t=this.max),this.valueChange.emit(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-options-select"]],hostVars:4,hostBindings:function(t,n){2&t&&e.ekj("fec-options-select",n.baseClass)("fec-options-select--disabled",n.disabled)},inputs:{disabled:"disabled",value:"value",min:"min",max:"max",enableMenu:"enableMenu"},outputs:{valueChange:"valueChange"},ngContentSelectors:T,decls:4,vars:2,consts:[["aria-label","previous option",1,"fec-options-select__button","fec-options-select__previous",3,"disabled","click"],[1,"fec-options-select__title"],["aria-label","next option",1,"fec-options-select__button","fec-options-select__next",3,"disabled","click"]],template:function(t,n){1&t&&(e.F$t(),e.TgZ(0,"button",0),e.NdJ("click",function(){return n.previous()}),e.qZA(),e.TgZ(1,"div",1),e.Hsn(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.next()}),e.qZA()),2&t&&(e.Q6J("disabled",n.disabled),e.xp6(3),e.Q6J("disabled",n.disabled))},styles:['.fec-options-select[_nghost-%COMP%]{display:flex;width:100%}.fec-options-select__title[_ngcontent-%COMP%], .fec-options-select__action[_ngcontent-%COMP%]{flex:1;text-align:center;position:relative}.fec-options-select__previous[_ngcontent-%COMP%]:before{display:block;content:"";width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:7px solid #111}.fec-options-select__next[_ngcontent-%COMP%]:before{display:block;content:"";width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:7px solid #111}']}),i})();var v=x(3860);const s=function(i){return{"color-options-palette__item--selected":i}},d=function(i){return{"background-color":i}};function r(i,C){if(1&i){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){const _=e.CHM(t).index,S=e.oxw();return S.indexSelected.emit(_),e.KtG(S.showPalette=!1)}),e.qZA()}if(2&i){const t=C.$implicit,n=C.index,a=e.oxw();e.Q6J("ngClass",e.VKq(2,s,n===a.index))("ngStyle",e.VKq(4,d,t))}}const l=function(i){return{"color-options-palette__options--show":i}};let p=(()=>{class i{onClickOutside(t){this.element.nativeElement.contains(t.target)||(this.showPalette=!1)}onEscape(t){this.showPalette=!1}constructor(t){this.element=t,this.baseClass=!0,this.disabled=!1,this.indexSelected=new e.vpe,this.showPalette=!1}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-color-options-palette"]],hostVars:4,hostBindings:function(t,n){1&t&&e.NdJ("mousedown",function(_){return n.onClickOutside(_)},!1,e.evT)("keydown.escape",function(_){return n.onEscape(_)}),2&t&&e.ekj("color-options-palette",n.baseClass)("color-options-palette--disabled",n.disabled)},inputs:{disabled:"disabled",colors:"colors",index:"index",title:"title"},outputs:{indexSelected:"indexSelected"},decls:4,vars:6,consts:[[1,"color-options-palette__select",3,"disabled","click"],[1,"color-options-palette__options",3,"ngClass"],["class","color-options-palette__item",3,"ngClass","ngStyle","click",4,"ngFor","ngForOf"],[1,"color-options-palette__item",3,"ngClass","ngStyle","click"]],template:function(t,n){1&t&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return n.showPalette=!n.showPalette}),e._uU(1),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,r,1,6,"button",2),e.qZA()),2&t&&(e.Q6J("disabled",n.disabled),e.xp6(1),e.hij(" ",n.title,"\n"),e.xp6(1),e.Q6J("ngClass",e.VKq(4,l,n.showPalette)),e.xp6(1),e.Q6J("ngForOf",n.colors))},dependencies:[h.mk,h.sg,h.PC],styles:[".color-options-palette[_nghost-%COMP%]{width:100%;position:relative}.color-options-palette__select[_ngcontent-%COMP%]{width:100%;height:100%}.color-options-palette__options[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:100%;z-index:2;top:100%;left:50%;transform:translate(-50%);margin-top:2px;padding:6px;background-color:#fff;box-shadow:1px 1px 1px #0000004d;display:none;grid-template-columns:repeat(8,1fr);grid-gap:3px}.color-options-palette__options--show[_ngcontent-%COMP%]{display:grid}.color-options-palette__item[_ngcontent-%COMP%]{aspect-ratio:1/1;border:0;border-radius:1px;box-shadow:0 1px 2px #00000080;border:1px solid rgba(0,0,0,0);box-sizing:border-box;cursor:pointer}.color-options-palette__item--selected[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.5);box-shadow:0 1px 2px #000000b3}"]}),i})();function u(i,C){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"fec-options-select",1),e.NdJ("valueChange",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.onColorListSelect(a))}),e.TgZ(2,"fec-color-options-palette",2),e.NdJ("indexSelected",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.onColorListSelect(a))}),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("value",t.value||0)("min",t.colorListOptions.min)("max",t.colorListOptions.max),e.xp6(1),e.Q6J("colors",t.colorListOptions.colors)("title",t.title)("index",t.value||0)}}let y=(()=>{class i{set colorSettings(t){t&&t.options&&(this.colorListOptions={colors:t.options,min:0,max:t.options.length-1})}constructor(t){this.colorService=t,this.result=new e.vpe,this.colorOptions=new e.vpe,this.randFunction=new e.vpe,this.colorListOptions=null,this.title="color"}ngOnChanges(t){!this.renderItem||!this.canvasSize||this.setData()}setData(){if(this.colorListOptions){const t=this.value||0;this.renderColorFromList(t),this.title=`${this.baseTitle} Color: ${t+1}`;const n=this.createRandFunctionForList();this.randFunction.emit(n)}}renderColor(t){const n=this.colorService.color(this.renderItem,t,{dimensions:this.canvasSize});this.result.emit(n)}renderColorFromList(t){this.renderColor(this.colorListOptions.colors[t])}onColorListSelect(t){this.value=t,this.colorOptions.emit(t)}createRandFunctionForList(){const t=this.colorListOptions.min,n=this.colorListOptions.max;return()=>E(t,n)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.x))},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-color-select"]],inputs:{colorSettings:"colorSettings",renderItem:"renderItem",canvasSize:"canvasSize",value:"value",baseTitle:"baseTitle"},outputs:{result:"result",colorOptions:"colorOptions",randFunction:"randFunction"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"value","min","max","valueChange"],[3,"colors","title","index","indexSelected"]],template:function(t,n){1&t&&e.YNc(0,u,3,6,"ng-container",0),2&t&&e.Q6J("ngIf",n.colorListOptions)},dependencies:[h.O5,m,p]}),i})();function I(i,C){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"fec-color-select",2),e.NdJ("result",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.onColorChange(a))})("colorOptions",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.colorChange.emit(a))})("randFunction",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.colorRandFunction.emit(a))}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("colorSettings",t.data.colorSettings)("baseTitle",t.data.title)("value",t.colorValue)("renderItem",t.currentRenderItem)("canvasSize",t.layerSize)}}let b=(()=>{class i{set layerSize(t){const{x:n,y:a}=t;this.width=n,this.height=a,this.canvas.height=t.y,this.canvas.width=t.x,this.ctx.clearRect(0,0,n,a),this._layerSize=t}get layerSize(){return this._layerSize}constructor(){this.baseClass=!0,this.layer=new e.vpe,this.indexChange=new e.vpe,this.colorChange=new e.vpe,this.randFunction=new e.vpe,this.colorRandFunction=new e.vpe,this.title="",this.min=0,this.max=0,this.width=0,this.height=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.blankIndex=-1}ngOnChanges(t){var n,a;this.data&&(this.setRender(),!(null===(n=t.data)||void 0===n)&&n.currentValue&&this.setMinMax(),this.title=this.getTitle(),null!==(a=this.data)&&void 0!==a&&a.colorSettings||this.renderBasicLayer())}getTitle(){var t;if(null===(t=this.currentRenderList)||void 0===t||!t.length)return this.data.assets?`${this.data.title}: ${this.index===this.blankIndex?"Off":"On"}`:this.data.title;let n;return n=this.data.canBeBlank&&-1===this.index?"None":this.data.optionLabels?this.data.optionLabels[this.index]:this.index+1,`${this.data.title}: ${n}`}renderBasicLayer(){this.draw(this.currentRenderItem),this.layer.emit(this.canvas)}draw(t){if(this.ctx.clearRect(0,0,this.width,this.height),t){const{x:n,y:a}=this.data.offset;this.ctx.drawImage(t,n,a)}}onColorChange(t){this.draw(t),this.layer.emit(this.canvas)}setIndex(t){this.index=t,this.indexChange.emit(t)}setRender(){this.data.dependsOn&&null!=this.dependsOnIndex?(this.currentRenderList=this.data.assets[this.dependsOnIndex],this.currentRenderItem=this.currentRenderList[this.index]):Array.isArray(this.data.assets)?(this.currentRenderList=this.data.assets,this.currentRenderItem=this.currentRenderList[this.index]):this.data.assets instanceof HTMLImageElement&&(this.currentRenderItem=this.index===this.blankIndex?null:this.data.assets)}setMinMax(){var t;this.min=this.data.canBeBlank?this.blankIndex:0,this.max=(null===(t=this.currentRenderList)||void 0===t?void 0:t.length)-1||0;const n=this.createRandFunction(this.min,this.max);this.randFunction.emit(n)}createRandFunction(t,n){return()=>E(t,n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-layer-renderer"]],hostVars:2,hostBindings:function(t,n){2&t&&e.ekj("fec-layer-renderer",n.baseClass)},inputs:{data:"data",index:"index",colorValue:"colorValue",dependsOnIndex:"dependsOnIndex",layerSize:"layerSize"},outputs:{layer:"layer",indexChange:"indexChange",colorChange:"colorChange",randFunction:"randFunction",colorRandFunction:"colorRandFunction"},features:[e.TTD],decls:3,vars:6,consts:[[3,"disabled","value","min","max","valueChange"],[4,"ngIf"],[3,"colorSettings","baseTitle","value","renderItem","canvasSize","result","colorOptions","randFunction"]],template:function(t,n){1&t&&(e.TgZ(0,"fec-options-select",0),e.NdJ("valueChange",function(_){return n.setIndex(_)}),e._uU(1),e.qZA(),e.YNc(2,I,2,5,"ng-container",1)),2&t&&(e.Q6J("disabled",!n.data.assets)("value",n.index)("min",n.min)("max",n.max),e.xp6(1),e.hij(" ",n.title,"\n"),e.xp6(1),e.Q6J("ngIf",n.data.colorSettings))},dependencies:[h.O5,m,y],styles:[".fec-layer-renderer[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%}"]}),i})();const B=["canvas"];function D(i,C){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"fec-layer-renderer",10),e.NdJ("layer",function(a){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.onLayerRender(a,S.name))})("indexChange",function(a){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.onIndexChange(a,S.name))})("colorChange",function(a){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.onColorChange(a,S.name))})("randFunction",function(a){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.setOptionRandomFunction(a,S.name))})("colorRandFunction",function(a){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.setColorRandomFunction(a,S.name))}),e.qZA()()}if(2&i){const t=C.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("data",t)("index",n.optionIndices[t.name])("dependsOnIndex",null!=t.dependsOn?n.optionIndices[t.dependsOn]:null)("layerSize",n.config.dimensions)("colorValue",n.colorCache[t.name])}}const j=function(i,C){return{height:i,width:C}};function k(i,C){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e._UZ(2,"canvas",3,4),e.qZA(),e.TgZ(4,"div",5)(5,"fec-options-select",6),e.NdJ("valueChange",function(a){e.CHM(t);const _=e.oxw();return e.KtG(_.bodyTypeIndex=a)}),e._uU(6),e.qZA(),e.TgZ(7,"ul",7),e.YNc(8,D,2,5,"li",8),e.qZA(),e.TgZ(9,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getRandom())}),e._uU(10,"Randomize!"),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.WLB(8,j,t.config.dimensions.y,t.config.dimensions.x)),e.xp6(1),e.Q6J("height",t.config.dimensions.y)("width",t.config.dimensions.x),e.xp6(3),e.Q6J("min",t.min)("max",t.max)("value",t.bodyTypeIndex),e.xp6(1),e.hij(" ",t.currentBodyType.title," "),e.xp6(2),e.Q6J("ngForOf",t.currentBodyType.config)}}function Z(i,C){if(1&i&&(e.TgZ(0,"div",11),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" loading ",e.lcZ(2,1,t.complete)," ")}}let z=(()=>{class i{set config(t){if(this._config=t,t){this.loaded=!0;const{x:n,y:a}=t.dimensions;this.currentBodyType=t.options[this.bodyTypeIndex],this.optionIndices={},this.renderCache={},this.colorCache={},this.currentBodyType.config.forEach(_=>{this.optionIndices[_.name]=_.canBeBlank?-1:0,this.renderCache[_.name]=null}),this.canvasFilledCount=0,this.canvas.height=a,this.canvas.width=n,this.max=t.options.length-1}}get config(){return this._config}set renderCanvas(t){t&&(this.renderCtx=t.nativeElement.getContext("2d"),this.delayedRender&&this.drawToCanvas(this.canvas))}set bodyTypeIndex(t){this._bodyTypeIndex=t,this.currentBodyType=this.config.options[t]}get bodyTypeIndex(){return this._bodyTypeIndex}constructor(){this.baseClass=!0,this.loaded=!1,this.image=new e.vpe,this.optionIndices={},this.renderCache={},this.colorCache={},this.optionRandFunc={},this.colorRandFunc={},this.min=0,this.max=0,this._bodyTypeIndex=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.delayedRender=!0,this.canvasFilledCount=0}ngOnInit(){}onLayerRender(t,n){this.renderCache[n]||this.canvasFilledCount++,this.renderCache[n]=t,this.render()}onIndexChange(t,n){this.optionIndices[n]=t}onColorChange(t,n){this.renderCache[n]||this.canvasFilledCount++,this.colorCache[n]=t}render(){if(this.canvasFilledCount<this.config.layerOrder.length)return;this.ctx.clearRect(0,0,this.config.dimensions.x,this.config.dimensions.y);const t=this.config.layerOrder;for(let n=t.length-1;n>=0;n--){const _=this.renderCache[t[n]];_&&this.ctx.drawImage(_,0,0)}this.renderCtx?this.drawToCanvas(this.canvas):this.delayedRender=!0}drawToCanvas(t){this.renderCtx.clearRect(0,0,this.config.dimensions.x,this.config.dimensions.y),this.renderCtx.drawImage(t,0,0),this.image.emit(t.toDataURL())}getRandom(){const t=E(this.min,this.max);this.config.menuOrder.forEach(n=>{const _=(0,this.optionRandFunc[n])(),S=this.colorRandFunc[n],P=S?S():void 0;(this.optionIndices[n]!==_||this.colorCache[n]!==P)&&(this.canvasFilledCount--,this.renderCache[n]=null),this.optionIndices[n]=_,this.colorCache[n]=P}),t!==this.bodyTypeIndex&&(this.canvasFilledCount=0,this.bodyTypeIndex=t,this.renderCache={}),this.optionIndices=Object.assign({},this.optionIndices),this.colorCache=Object.assign({},this.colorCache)}setOptionRandomFunction(t,n){this.optionRandFunc[n]=t}setColorRandomFunction(t,n){this.colorRandFunc[n]=t}trackByIndex(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-renderer"]],viewQuery:function(t,n){if(1&t&&e.Gf(B,5),2&t){let a;e.iGM(a=e.CRH())&&(n.renderCanvas=a.first)}},hostVars:4,hostBindings:function(t,n){2&t&&e.ekj("fec-renderer",n.baseClass)("fec-renderer--loaded",n.loaded)},inputs:{complete:"complete",config:"config"},outputs:{image:"image"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"fec-renderer__canvas-container",3,"ngStyle"],[1,"fec-renderer__canvas",3,"height","width"],["canvas",""],[1,"fec-renderer__controls"],[3,"min","max","value","valueChange"],[1,"fec-renderer__options"],[4,"ngFor","ngForOf"],[1,"fec-renderer__randomize",3,"click"],[3,"data","index","dependsOnIndex","layerSize","colorValue","layer","indexChange","colorChange","randFunction","colorRandFunction"],[1,"fec-renderer__loading"]],template:function(t,n){if(1&t&&(e.YNc(0,k,11,11,"ng-container",0),e.YNc(1,Z,3,3,"ng-template",null,1,e.W1O)),2&t){const a=e.MAs(2);e.Q6J("ngIf",n.config)("ngIfElse",a)}},dependencies:[h.sg,h.O5,h.PC,m,b,h.Zx],styles:[".fec-renderer[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.fec-renderer__controls[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column;width:255px}.fec-renderer__options[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;padding:0;margin:0;list-style:none}.fec-renderer__options[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100%}"]}),i})()},7339:($,L,x)=>{x.d(L,{K:()=>P});var e=x(4755),E=x(872),h=x(9523),T=x(7579);const m={now:()=>(m.delegate||Date).now(),delegate:void 0};class v extends T.x{constructor(o=1/0,c=1/0,f=m){super(),this._bufferSize=o,this._windowTime=c,this._timestampProvider=f,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=c===1/0,this._bufferSize=Math.max(1,o),this._windowTime=Math.max(1,c)}next(o){const{isStopped:c,_buffer:f,_infiniteTimeWindow:w,_timestampProvider:O,_windowTime:R}=this;c||(f.push(o),!w&&f.push(O.now()+R)),this._trimBuffer(),super.next(o)}_subscribe(o){this._throwIfClosed(),this._trimBuffer();const c=this._innerSubscribe(o),{_infiniteTimeWindow:f,_buffer:w}=this,O=w.slice();for(let R=0;R<O.length&&!o.closed;R+=f?1:2)o.next(O[R]);return this._checkFinalizedStatuses(o),c}_trimBuffer(){const{_bufferSize:o,_timestampProvider:c,_buffer:f,_infiniteTimeWindow:w}=this,O=(w?1:2)*o;if(o<1/0&&O<f.length&&f.splice(0,f.length-O),!w){const R=c.now();let F=0;for(let M=1;M<f.length&&f[M]<=R;M+=2)F=M;F&&f.splice(0,F+1)}}}var s=x(6451),d=x(3900),r=x(4004);const l={schedule(g,o){const c=setTimeout(g,o);return()=>clearTimeout(c)},scheduleBeforeRender(g){if(typeof window>"u")return l.schedule(g,0);if(typeof window.requestAnimationFrame>"u")return l.schedule(g,16);const o=window.requestAnimationFrame(g);return()=>window.cancelAnimationFrame(o)}};let b;function z(g,o,c){let f=c;return function u(g){return!!g&&g.nodeType===Node.ELEMENT_NODE}(g)&&o.some((w,O)=>!("*"===w||!function B(g,o){if(!b){const c=Element.prototype;b=c.matches||c.matchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector||c.webkitMatchesSelector}return g.nodeType===Node.ELEMENT_NODE&&b.call(g,o)}(g,w)||(f=O,0))),f}class C{constructor(o,c){this.componentFactory=c.get(h._Vd).resolveComponentFactory(o)}create(o){return new t(this.componentFactory,o)}}class t{constructor(o,c){this.componentFactory=o,this.injector=c,this.eventEmitters=new v(1),this.events=this.eventEmitters.pipe((0,d.w)(f=>(0,s.T)(...f))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:f})=>f)),this.ngZone=this.injector.get(h.R0b),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(o){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(o)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=l.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(o){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(o):this.componentRef.instance[o])}setInputValue(o,c){this.runInZone(()=>{null!==this.componentRef?function D(g,o){return g===o||g!=g&&o!=o}(c,this.getInputValue(o))&&(void 0!==c||!this.unchangedInputs.has(o))||(this.recordInputChange(o,c),this.unchangedInputs.delete(o),this.hasInputChanges=!0,this.componentRef.instance[o]=c,this.scheduleDetectChanges()):this.initialInputValues.set(o,c)})}initializeComponent(o){const c=h.zs3.create({providers:[],parent:this.injector}),f=function Z(g,o){const c=g.childNodes,f=o.map(()=>[]);let w=-1;o.some((O,R)=>"*"===O&&(w=R,!0));for(let O=0,R=c.length;O<R;++O){const F=c[O],M=z(F,o,w);-1!==M&&f[M].push(F)}return f}(o,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(c,f,o),this.viewChangeDetectorRef=this.componentRef.injector.get(h.sBO),this.implementsOnChanges=function y(g){return"function"==typeof g}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(h.z2F).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:o})=>{this.initialInputValues.has(o)&&this.setInputValue(o,this.initialInputValues.get(o))}),this.initialInputValues.clear()}initializeOutputs(o){const c=this.componentFactory.outputs.map(({propName:f,templateName:w})=>o.instance[f].pipe((0,r.U)(R=>({name:w,value:R}))));this.eventEmitters.next(c)}callNgOnChanges(o){if(!this.implementsOnChanges||null===this.inputChanges)return;const c=this.inputChanges;this.inputChanges=null,o.instance.ngOnChanges(c)}markViewForCheck(o){this.hasInputChanges&&(this.hasInputChanges=!1,o.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=l.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(o,c){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const f=this.inputChanges[o];if(f)return void(f.currentValue=c);const w=this.unchangedInputs.has(o),O=w?void 0:this.getInputValue(o);this.inputChanges[o]=new h.WD2(O,c,w)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(o){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(o):o()}}class n extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}var S=x(3860);let P=(()=>{class g{constructor(c){this.injector=c;const f=function a(g,o){const c=function k(g,o){return o.get(h._Vd).resolveComponentFactory(g).inputs}(g,o.injector),f=o.strategyFactory||new C(g,o.injector),w=function j(g){const o={};return g.forEach(({propName:c,templateName:f})=>{o[function p(g){return g.replace(/[A-Z]/g,o=>`-${o.toLowerCase()}`)}(f)]=c}),o}(c);class O extends n{get ngElementStrategy(){if(!this._ngElementStrategy){const F=this._ngElementStrategy=f.create(this.injector||o.injector);c.forEach(({propName:M})=>{if(!this.hasOwnProperty(M))return;const V=this[M];delete this[M],F.setInputValue(M,V)})}return this._ngElementStrategy}constructor(F){super(),this.injector=F}attributeChangedCallback(F,M,V,J){this.ngElementStrategy.setInputValue(w[F],V)}connectedCallback(){let F=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),F=!0),this.ngElementStrategy.connect(this),F||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(F=>{const M=new CustomEvent(F.name,{detail:F.value});this.dispatchEvent(M)})}}return O.observedAttributes=Object.keys(w),c.forEach(({propName:R})=>{Object.defineProperty(O.prototype,R,{get(){return this.ngElementStrategy.getInputValue(R)},set(F){this.ngElementStrategy.setInputValue(R,F)},configurable:!0,enumerable:!0})}),O}(E.J,{injector:this.injector});customElements.get("fe-custom-renderer")||customElements.define("fe-custom-renderer",f)}ngDoBoostrap(){}}return g.\u0275fac=function(c){return new(c||g)(h.LFG(h.zs3))},g.\u0275mod=h.oAB({type:g}),g.\u0275inj=h.cJS({providers:[S.x],imports:[e.ez]}),g})()},3860:($,L,x)=>{x.d(L,{x:()=>E});var e=x(9523);let E=(()=>{class h{constructor(){this.canvas1=document.createElement("canvas"),this.canvas2=document.createElement("canvas"),this.ctx1=this.canvas1.getContext("2d"),this.ctx2=this.canvas2.getContext("2d"),this.width=0,this.height=0}color(m,v,s){const{x:d,y:r}=s.dimensions;this.setSize(d,r);const l=this.ctx1,p=this.ctx2;return p.clearRect(0,0,d,r),l.drawImage(m,0,0),p.globalCompositeOperation="source-over",p.drawImage(m,0,0),l.globalCompositeOperation="source-over",l.drawImage(m,0,0),this.overlayFilter(p,v),l.drawImage(this.canvas2,0,0),l.globalCompositeOperation="source-over",p.globalCompositeOperation="source-over",p.clearRect(0,0,255,255),this.canvas1}overlayFilter(m,v){const s=this.hexToRGBA(v),d=(u,y)=>{const I=u/255,b=y/255;return Math.round(255*(I<.5?2*I*b:1-2*(1-I)*(1-b)))},r=m.getImageData(0,0,256,256),l=u=>{r?.data&&(r.data[u]=d(r.data[u],s.r),r.data[u+1]=d(r.data[u+1],s.g),r.data[u+2]=d(r.data[u+2],s.b))},p=u=>0!=r.data[u+3];for(let u=0;u<r.data.length;u+=4)p(u)&&l(u);m.putImageData(r,0,0)}setSize(m,v){this.canvas1.width=m,this.canvas1.height=v,this.canvas2.width=m,this.canvas2.height=v,this.width=m,this.height=v}hexToRGBA(m,v=1){const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(m);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16),a:v}:null}}return h.\u0275fac=function(m){return new(m||h)},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},4133:($,L,x)=>{x.d(L,{I:()=>E});var e=x(9523);let E=(()=>{class h{constructor(){}save(m,v){const s=document.createElement("a");s.download=v,s.href=m,s.click(),s.remove()}}return h.\u0275fac=function(m){return new(m||h)},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},7843:($,L,x)=>{x.d(L,{D:()=>T});var e=x(4004),E=x(1135),h=x(9523);let T=(()=>{class m{constructor(){}getConfig(s){const d=this.generateImagePathConfig(s);return this.loadImagesFromLocal(d).pipe((0,e.U)(r=>{const l=r.loaded/r.count,p=r.images;if(p){const u=this.generateConfig(s.bodyOptions,{baseKey:s.rootKey,assets:p,menuOrder:s.menuOrder});return{complete:l,data:{dimensions:s.dimensions,options:u,menuOrder:s.menuOrder,layerOrder:s.layerOrder}}}return{complete:l,data:null}}))}loadImagesFromLocal(s){const d=[],r={},l=(y,I,b)=>{var B;const D=I?`${I} ${b.name}`:b.name,j=[y,b.path].join("/");if(null!==(B=b.subCategories)&&void 0!==B&&B.length)for(const k of b.subCategories)l(j,D,k);else d.push({key:D,path:j})};l("",null,s);const p=new E.X({count:d.length,loaded:0,images:null});let u=0;return d.forEach(y=>{const I=new Image;I.addEventListener("load",()=>{r[y.key]=I,u++,u===d.length?(p.next({count:d.length,loaded:u,images:r}),p.complete()):p.next({count:d.length,loaded:u,images:null})}),I.src=y.path}),p.asObservable()}generateImagePathConfig(s){const{rootKey:d,rootPath:r,imageType:l,bodyOptions:p}=s;return{name:d,path:r,subCategories:Object.keys(p).map(y=>{const I=p[y],b=[],B=I.options;for(const j of Object.keys(I.options)){const k=B[j];this.doOnOptionType(k,()=>{b.push({name:j,path:`${k.path}.${l}`})},Z=>{const z=this.getGeneralPaths(Z,l);b.push({name:j,path:k.path,subCategories:z})},Z=>{const i=this.getDependentPaths(B[Z].count,k.childOptions,l);b.push({name:j,path:k.path,subCategories:i})})}return{name:y,path:I.path,subCategories:b}})}}getGeneralPaths(s,d){const r=[];for(let l=1;l<=s;l++)r.push({name:`${l}`,path:`${l}.${d}`});return r}getDependentPaths(s,d,r){const l=[];for(let p=1;p<=s;p++)Object.keys(d).forEach(u=>{l.push({name:`${p}_${u}`,path:`${p}_${d[u].path}.${r}`})});return l}generateConfig(s,d){return Object.keys(s).map(r=>({bodyType:r,title:s[r].title,config:this.generateConfigForBodyType(r,s[r],d)}))}generateConfigForBodyType(s,d,r){return r.menuOrder.map(l=>{const p=d.options,u=p[l];return this.doOnOptionType(u,()=>this.getToggleOptionConfig(s,l,u,r),y=>this.getStandardOptionConfig(s,l,u,r),y=>this.getDependentOptionConfig(s,l,u,y,p[y].count,r),()=>this.getNullOptionConfig(l))})}getToggleOptionConfig(s,d,r,l){const p=`${l.baseKey} ${s} ${d}`;return Object.assign(Object.assign({},this.getConfigWithTitle(d,r)),{canBeBlank:!0,assets:l.assets[p]})}getStandardOptionConfig(s,d,r,l){const p=this.getConfigWithTitle(d,r),u=`${l.baseKey} ${s} ${p.name}`;return Object.assign(Object.assign({},p),{assets:this.getAssetsForType(u,r.count,l.assets)})}getNullOptionConfig(s){return Object.assign(Object.assign({},this.getConfigWithTitle(s)),{assets:null})}getDependentOptionConfig(s,d,r,l,p,u){const y=this.getConfigWithTitle(d,r),I=`${u.baseKey} ${s} ${y.name}`,b=Object.keys(r.childOptions);return Object.assign(Object.assign({},y),{assets:this.getAssetsForType(I,p,u.assets,b),dependsOn:l})}getAssetsForType(s,d,r,l){if(!d)return null;const p=[];for(let u=1;u<=d;u++)if(l?.length){const y=l.map(I=>r[`${s} ${u}_${I}`]);p.push(y)}else p.push(r[`${s} ${u}`]);return p}getConfigWithTitle(s,d){if(!d)return{name:s,title:"--",offset:null,canBeBlank:!0,assets:null};const r={name:s,title:d.title,offset:d.offset,canBeBlank:d.canBeBlank||!1,colorSettings:d.colorSettings,assets:null};return d.childOptions?Object.assign(Object.assign({},r),{optionLabels:Object.values(d.childOptions).map(l=>l.title)}):Object.assign({},r)}doOnOptionType(s,d,r,l,p){return s?.toggleable?d():s?.count?r(s.count):s?.dependsOn?l(s.dependsOn):p?p():void 0}}return m.\u0275fac=function(s){return new(s||m)},m.\u0275prov=h.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},8037:($,L,x)=>{x.d(L,{d:()=>E});var e=x(9523);let E=(()=>{class h{constructor(){this.configStore={}}getConfig(m){return this.configStore[m]}setConfig(m,v){this.configStore[m]=v}}return h.\u0275fac=function(m){return new(m||h)},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);