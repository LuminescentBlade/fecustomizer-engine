"use strict";(self.webpackChunkkamui_customizer=self.webpackChunkkamui_customizer||[]).push([[63],{6018:(j,L,x)=>{x.d(L,{I:()=>h});var e=x(6814),M=x(4769);let h=(()=>{class T{constructor(y){this._baseHref=y}getBasePath(y){return[".",this._baseHref.split("/").join(""),y].filter(s=>s.length).join("/")}}return T.\u0275fac=function(y){return new(y||T)(M.LFG(e.mr))},T.\u0275prov=M.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},870:(j,L,x)=>{x.d(L,{J:()=>$});var e=x(4769);function M(i,C){return i+Math.floor((C-i+1)*Math.random())}var h=x(6814);const T=["*"];let g=(()=>{class i{constructor(){this.baseClass=!0,this.disabled=!1,this.enableMenu=!1,this.valueChange=new e.vpe}ngOnInit(){}next(){let t=this.value+1;t>this.max&&(t=this.min),this.valueChange.emit(t)}previous(){let t=this.value-1;t<this.min&&(t=this.max),this.valueChange.emit(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-options-select"]],hostVars:4,hostBindings:function(t,n){2&t&&e.ekj("fec-options-select",n.baseClass)("fec-options-select--disabled",n.disabled)},inputs:{disabled:"disabled",value:"value",min:"min",max:"max",enableMenu:"enableMenu"},outputs:{valueChange:"valueChange"},ngContentSelectors:T,decls:4,vars:2,consts:[["aria-label","previous option",1,"fec-options-select__button","fec-options-select__previous",3,"disabled","click"],[1,"fec-options-select__title"],["aria-label","next option",1,"fec-options-select__button","fec-options-select__next",3,"disabled","click"]],template:function(t,n){1&t&&(e.F$t(),e.TgZ(0,"button",0),e.NdJ("click",function(){return n.previous()}),e.qZA(),e.TgZ(1,"div",1),e.Hsn(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.next()}),e.qZA()),2&t&&(e.Q6J("disabled",n.disabled),e.xp6(3),e.Q6J("disabled",n.disabled))},styles:['.fec-options-select[_nghost-%COMP%]{display:flex;width:100%}.fec-options-select__title[_ngcontent-%COMP%], .fec-options-select__action[_ngcontent-%COMP%]{flex:1;text-align:center;position:relative}.fec-options-select__previous[_ngcontent-%COMP%]:before{display:block;content:"";width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:7px solid #111}.fec-options-select__next[_ngcontent-%COMP%]:before{display:block;content:"";width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:7px solid #111}']}),i})();var y=x(1386);const s=function(i){return{"color-options-palette__item--selected":i}},d=function(i){return{"background-color":i}};function a(i,C){if(1&i){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){const _=e.CHM(t).index,S=e.oxw();return S.indexSelected.emit(_),e.KtG(S.showPalette=!1)}),e.qZA()}if(2&i){const t=C.$implicit,n=C.index,l=e.oxw();e.Q6J("ngClass",e.VKq(2,s,n===l.index))("ngStyle",e.VKq(4,d,t))}}const c=function(i){return{"color-options-palette__options--show":i}};let p=(()=>{class i{onClickOutside(t){this.element.nativeElement.contains(t.target)||(this.showPalette=!1)}onEscape(t){this.showPalette=!1}constructor(t){this.element=t,this.baseClass=!0,this.disabled=!1,this.indexSelected=new e.vpe,this.showPalette=!1}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-color-options-palette"]],hostVars:4,hostBindings:function(t,n){1&t&&e.NdJ("mousedown",function(_){return n.onClickOutside(_)},!1,e.evT)("keydown.escape",function(_){return n.onEscape(_)}),2&t&&e.ekj("color-options-palette",n.baseClass)("color-options-palette--disabled",n.disabled)},inputs:{disabled:"disabled",colors:"colors",index:"index",title:"title"},outputs:{indexSelected:"indexSelected"},decls:4,vars:6,consts:[[1,"color-options-palette__select",3,"disabled","click"],[1,"color-options-palette__options",3,"ngClass"],["class","color-options-palette__item",3,"ngClass","ngStyle","click",4,"ngFor","ngForOf"],[1,"color-options-palette__item",3,"ngClass","ngStyle","click"]],template:function(t,n){1&t&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return n.showPalette=!n.showPalette}),e._uU(1),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,a,1,6,"button",2),e.qZA()),2&t&&(e.Q6J("disabled",n.disabled),e.xp6(1),e.hij(" ",n.title,"\n"),e.xp6(1),e.Q6J("ngClass",e.VKq(4,c,n.showPalette)),e.xp6(1),e.Q6J("ngForOf",n.colors))},dependencies:[h.mk,h.sg,h.PC],styles:[".color-options-palette[_nghost-%COMP%]{width:100%;position:relative}.color-options-palette__select[_ngcontent-%COMP%]{width:100%;height:100%}.color-options-palette__options[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;width:100%;z-index:2;top:100%;left:50%;transform:translate(-50%);margin-top:2px;padding:6px;background-color:#fff;box-shadow:1px 1px 1px #0000004d;display:none;grid-template-columns:repeat(8,1fr);grid-gap:3px}.color-options-palette__options--show[_ngcontent-%COMP%]{display:grid}.color-options-palette__item[_ngcontent-%COMP%]{aspect-ratio:1/1;border:0;border-radius:1px;box-shadow:0 1px 2px #00000080;border:1px solid rgba(0,0,0,0);box-sizing:border-box;cursor:pointer}.color-options-palette__item--selected[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.5);box-shadow:0 1px 2px #000000b3}"]}),i})();function u(i,C){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"fec-options-select",1),e.NdJ("valueChange",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.onColorListSelect(l))}),e.TgZ(2,"fec-color-options-palette",2),e.NdJ("indexSelected",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.onColorListSelect(l))}),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("value",t.value||0)("min",t.colorListOptions.min)("max",t.colorListOptions.max),e.xp6(1),e.Q6J("colors",t.colorListOptions.colors)("title",t.title)("index",t.value||0)}}let v=(()=>{class i{set colorSettings(t){t&&t.options&&(this.colorListOptions={colors:t.options,min:0,max:t.options.length-1})}constructor(t){this.colorService=t,this.result=new e.vpe,this.colorOptions=new e.vpe,this.randFunction=new e.vpe,this.colorListOptions=null,this.title="color"}ngOnChanges(t){!this.renderItem||!this.canvasSize||this.setData()}setData(){if(this.colorListOptions){const t=this.value||0;this.renderColorFromList(t),this.title=`${this.baseTitle} Color: ${t+1}`;const n=this.createRandFunctionForList();this.randFunction.emit(n)}}renderColor(t){const n=this.colorService.color(this.renderItem,t,{dimensions:this.canvasSize});this.result.emit(n)}renderColorFromList(t){this.renderColor(this.colorListOptions.colors[t])}onColorListSelect(t){this.value=t,this.colorOptions.emit(t)}createRandFunctionForList(){const t=this.colorListOptions.min,n=this.colorListOptions.max;return()=>M(t,n)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.x))},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-color-select"]],inputs:{colorSettings:"colorSettings",renderItem:"renderItem",canvasSize:"canvasSize",value:"value",baseTitle:"baseTitle"},outputs:{result:"result",colorOptions:"colorOptions",randFunction:"randFunction"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"value","min","max","valueChange"],[3,"colors","title","index","indexSelected"]],template:function(t,n){1&t&&e.YNc(0,u,3,6,"ng-container",0),2&t&&e.Q6J("ngIf",n.colorListOptions)},dependencies:[h.O5,g,p]}),i})();function w(i,C){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"fec-color-select",2),e.NdJ("result",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.onColorChange(l))})("colorOptions",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.colorChange.emit(l))})("randFunction",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.colorRandFunction.emit(l))}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("colorSettings",t.data.colorSettings)("baseTitle",t.data.title)("value",t.colorValue)("renderItem",t.currentRenderItem)("canvasSize",t.layerSize)}}let b=(()=>{class i{set layerSize(t){const{x:n,y:l}=t;this.width=n,this.height=l,this.canvas.height=t.y,this.canvas.width=t.x,this.ctx.clearRect(0,0,n,l),this._layerSize=t}get layerSize(){return this._layerSize}constructor(){this.baseClass=!0,this.layer=new e.vpe,this.indexChange=new e.vpe,this.colorChange=new e.vpe,this.randFunction=new e.vpe,this.colorRandFunction=new e.vpe,this.title="",this.min=0,this.max=0,this.width=0,this.height=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.blankIndex=-1}ngOnChanges(t){this.data&&(this.setRender(),t.data?.currentValue&&this.setMinMax(),this.title=this.getTitle(),this.data?.colorSettings||this.renderBasicLayer())}getTitle(){if(!this.currentRenderList?.length)return this.data.assets?`${this.data.title}: ${this.index===this.blankIndex?"Off":"On"}`:this.data.title;let t;return t=this.data.canBeBlank&&-1===this.index?"None":this.data.optionLabels?this.data.optionLabels[this.index]:this.index+1,`${this.data.title}: ${t}`}renderBasicLayer(){this.draw(this.currentRenderItem),this.layer.emit(this.canvas)}draw(t){if(this.ctx.clearRect(0,0,this.width,this.height),t){const{x:n,y:l}=this.data.offset;this.ctx.drawImage(t,n,l)}}onColorChange(t){this.draw(t),this.layer.emit(this.canvas)}setIndex(t){this.index=t,this.indexChange.emit(t)}setRender(){this.data.dependsOn&&null!=this.dependsOnIndex?(this.currentRenderList=this.data.assets[this.dependsOnIndex],this.currentRenderItem=this.currentRenderList[this.index]):Array.isArray(this.data.assets)?(this.currentRenderList=this.data.assets,this.currentRenderItem=this.currentRenderList[this.index]):this.data.assets instanceof HTMLImageElement&&(this.currentRenderItem=this.index===this.blankIndex?null:this.data.assets)}setMinMax(){this.min=this.data.canBeBlank?this.blankIndex:0,this.max=this.currentRenderList?.length-1||0;const t=this.createRandFunction(this.min,this.max);this.randFunction.emit(t)}createRandFunction(t,n){return()=>M(t,n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-layer-renderer"]],hostVars:2,hostBindings:function(t,n){2&t&&e.ekj("fec-layer-renderer",n.baseClass)},inputs:{data:"data",index:"index",colorValue:"colorValue",dependsOnIndex:"dependsOnIndex",layerSize:"layerSize"},outputs:{layer:"layer",indexChange:"indexChange",colorChange:"colorChange",randFunction:"randFunction",colorRandFunction:"colorRandFunction"},features:[e.TTD],decls:3,vars:6,consts:[[3,"disabled","value","min","max","valueChange"],[4,"ngIf"],[3,"colorSettings","baseTitle","value","renderItem","canvasSize","result","colorOptions","randFunction"]],template:function(t,n){1&t&&(e.TgZ(0,"fec-options-select",0),e.NdJ("valueChange",function(_){return n.setIndex(_)}),e._uU(1),e.qZA(),e.YNc(2,w,2,5,"ng-container",1)),2&t&&(e.Q6J("disabled",!n.data.assets)("value",n.index)("min",n.min)("max",n.max),e.xp6(1),e.hij(" ",n.title,"\n"),e.xp6(1),e.Q6J("ngIf",n.data.colorSettings))},dependencies:[h.O5,g,v],styles:[".fec-layer-renderer[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%}"]}),i})();const B=["canvas"];function Z(i,C){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"fec-layer-renderer",10),e.NdJ("layer",function(l){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.onLayerRender(l,S.name))})("indexChange",function(l){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.onIndexChange(l,S.name))})("colorChange",function(l){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.onColorChange(l,S.name))})("randFunction",function(l){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.setOptionRandomFunction(l,S.name))})("colorRandFunction",function(l){const S=e.CHM(t).$implicit,P=e.oxw(2);return e.KtG(P.setColorRandomFunction(l,S.name))}),e.qZA()()}if(2&i){const t=C.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("data",t)("index",n.optionIndices[t.name])("dependsOnIndex",null!=t.dependsOn?n.optionIndices[t.dependsOn]:null)("layerSize",n.config.dimensions)("colorValue",n.colorCache[t.name])}}const k=function(i,C){return{height:i,width:C}};function D(i,C){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2),e._UZ(2,"canvas",3,4),e.qZA(),e.TgZ(4,"div",5)(5,"fec-options-select",6),e.NdJ("valueChange",function(l){e.CHM(t);const _=e.oxw();return e.KtG(_.bodyTypeIndex=l)}),e._uU(6),e.qZA(),e.TgZ(7,"ul",7),e.YNc(8,Z,2,5,"li",8),e.qZA(),e.TgZ(9,"button",9),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.getRandom())}),e._uU(10,"Randomize!"),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.WLB(8,k,t.config.dimensions.y,t.config.dimensions.x)),e.xp6(1),e.Q6J("height",t.config.dimensions.y)("width",t.config.dimensions.x),e.xp6(3),e.Q6J("min",t.min)("max",t.max)("value",t.bodyTypeIndex),e.xp6(1),e.hij(" ",t.currentBodyType.title," "),e.xp6(2),e.Q6J("ngForOf",t.currentBodyType.config)}}function z(i,C){if(1&i&&(e.TgZ(0,"div",11),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" loading ",e.lcZ(2,1,t.complete)," ")}}let $=(()=>{class i{set config(t){if(this._config=t,t){this.loaded=!0;const{x:n,y:l}=t.dimensions;this.currentBodyType=t.options[this.bodyTypeIndex],this.optionIndices={},this.renderCache={},this.colorCache={},this.currentBodyType.config.forEach(_=>{this.optionIndices[_.name]=_.canBeBlank?-1:0,this.renderCache[_.name]=null}),this.canvasFilledCount=0,this.canvas.height=l,this.canvas.width=n,this.max=t.options.length-1}}get config(){return this._config}set renderCanvas(t){t&&(this.renderCtx=t.nativeElement.getContext("2d"),this.delayedRender&&this.drawToCanvas(this.canvas))}set bodyTypeIndex(t){this._bodyTypeIndex=t,this.currentBodyType=this.config.options[t]}get bodyTypeIndex(){return this._bodyTypeIndex}constructor(){this.baseClass=!0,this.loaded=!1,this.image=new e.vpe,this.optionIndices={},this.renderCache={},this.colorCache={},this.optionRandFunc={},this.colorRandFunc={},this.min=0,this.max=0,this._bodyTypeIndex=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.delayedRender=!0,this.canvasFilledCount=0}ngOnInit(){}onLayerRender(t,n){this.renderCache[n]||this.canvasFilledCount++,this.renderCache[n]=t,this.render()}onIndexChange(t,n){this.optionIndices[n]=t}onColorChange(t,n){this.renderCache[n]||this.canvasFilledCount++,this.colorCache[n]=t}render(){if(this.canvasFilledCount<this.config.layerOrder.length)return;this.ctx.clearRect(0,0,this.config.dimensions.x,this.config.dimensions.y);const t=this.config.layerOrder;for(let n=t.length-1;n>=0;n--){const _=this.renderCache[t[n]];_&&this.ctx.drawImage(_,0,0)}this.renderCtx?this.drawToCanvas(this.canvas):this.delayedRender=!0}drawToCanvas(t){this.renderCtx.clearRect(0,0,this.config.dimensions.x,this.config.dimensions.y),this.renderCtx.drawImage(t,0,0),this.image.emit(t.toDataURL())}getRandom(){const t=M(this.min,this.max);this.config.menuOrder.forEach(n=>{const _=(0,this.optionRandFunc[n])(),S=this.colorRandFunc[n],P=S?S():void 0;(this.optionIndices[n]!==_||this.colorCache[n]!==P)&&(this.canvasFilledCount--,this.renderCache[n]=null),this.optionIndices[n]=_,this.colorCache[n]=P}),t!==this.bodyTypeIndex&&(this.canvasFilledCount=0,this.bodyTypeIndex=t,this.renderCache={}),this.optionIndices={...this.optionIndices},this.colorCache={...this.colorCache}}setOptionRandomFunction(t,n){this.optionRandFunc[n]=t}setColorRandomFunction(t,n){this.colorRandFunc[n]=t}trackByIndex(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["fec-renderer"]],viewQuery:function(t,n){if(1&t&&e.Gf(B,5),2&t){let l;e.iGM(l=e.CRH())&&(n.renderCanvas=l.first)}},hostVars:4,hostBindings:function(t,n){2&t&&e.ekj("fec-renderer",n.baseClass)("fec-renderer--loaded",n.loaded)},inputs:{complete:"complete",config:"config"},outputs:{image:"image"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"fec-renderer__canvas-container",3,"ngStyle"],[1,"fec-renderer__canvas",3,"height","width"],["canvas",""],[1,"fec-renderer__controls"],[3,"min","max","value","valueChange"],[1,"fec-renderer__options"],[4,"ngFor","ngForOf"],[1,"fec-renderer__randomize",3,"click"],[3,"data","index","dependsOnIndex","layerSize","colorValue","layer","indexChange","colorChange","randFunction","colorRandFunction"],[1,"fec-renderer__loading"]],template:function(t,n){if(1&t&&(e.YNc(0,D,11,11,"ng-container",0),e.YNc(1,z,3,3,"ng-template",null,1,e.W1O)),2&t){const l=e.MAs(2);e.Q6J("ngIf",n.config)("ngIfElse",l)}},dependencies:[h.sg,h.O5,h.PC,g,b,h.Zx],styles:[".fec-renderer[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.fec-renderer__controls[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column;width:255px}.fec-renderer__options[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;padding:0;margin:0;list-style:none}.fec-renderer__options[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100%}"]}),i})()},4339:(j,L,x)=>{x.d(L,{K:()=>P});var e=x(6814),M=x(870),h=x(4769),T=x(8645);const g={now:()=>(g.delegate||Date).now(),delegate:void 0};class y extends T.x{constructor(o=1/0,r=1/0,f=g){super(),this._bufferSize=o,this._windowTime=r,this._timestampProvider=f,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=r===1/0,this._bufferSize=Math.max(1,o),this._windowTime=Math.max(1,r)}next(o){const{isStopped:r,_buffer:f,_infiniteTimeWindow:O,_timestampProvider:I,_windowTime:R}=this;r||(f.push(o),!O&&f.push(I.now()+R)),this._trimBuffer(),super.next(o)}_subscribe(o){this._throwIfClosed(),this._trimBuffer();const r=this._innerSubscribe(o),{_infiniteTimeWindow:f,_buffer:O}=this,I=O.slice();for(let R=0;R<I.length&&!o.closed;R+=f?1:2)o.next(I[R]);return this._checkFinalizedStatuses(o),r}_trimBuffer(){const{_bufferSize:o,_timestampProvider:r,_buffer:f,_infiniteTimeWindow:O}=this,I=(O?1:2)*o;if(o<1/0&&I<f.length&&f.splice(0,f.length-I),!O){const R=r.now();let F=0;for(let E=1;E<f.length&&f[E]<=R;E+=2)F=E;F&&f.splice(0,F+1)}}}var s=x(3019),d=x(4664),a=x(7398);const c={schedule(m,o){const r=setTimeout(m,o);return()=>clearTimeout(r)},scheduleBeforeRender(m){if(typeof window>"u")return c.schedule(m,0);if(typeof window.requestAnimationFrame>"u")return c.schedule(m,16);const o=window.requestAnimationFrame(m);return()=>window.cancelAnimationFrame(o)}};let b;function $(m,o,r){let f=r;return function u(m){return!!m&&m.nodeType===Node.ELEMENT_NODE}(m)&&o.some((O,I)=>!("*"===O||!function B(m,o){if(!b){const r=Element.prototype;b=r.matches||r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}return m.nodeType===Node.ELEMENT_NODE&&b.call(m,o)}(m,O)||(f=I,0))),f}class C{constructor(o,r){this.componentFactory=r.get(h._Vd).resolveComponentFactory(o)}create(o){return new t(this.componentFactory,o)}}class t{constructor(o,r){this.componentFactory=o,this.injector=r,this.eventEmitters=new y(1),this.events=this.eventEmitters.pipe((0,d.w)(f=>(0,s.T)(...f))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:f})=>f)),this.ngZone=this.injector.get(h.R0b),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(o){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(o)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=c.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(o){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(o):this.componentRef.instance[o])}setInputValue(o,r,f){this.runInZone(()=>{f&&(r=f.call(this.componentRef?.instance,r)),null!==this.componentRef?function Z(m,o){return m===o||m!=m&&o!=o}(r,this.getInputValue(o))&&(void 0!==r||!this.unchangedInputs.has(o))||(this.recordInputChange(o,r),this.unchangedInputs.delete(o),this.hasInputChanges=!0,this.componentRef.instance[o]=r,this.scheduleDetectChanges()):this.initialInputValues.set(o,r)})}initializeComponent(o){const r=h.zs3.create({providers:[],parent:this.injector}),f=function z(m,o){const r=m.childNodes,f=o.map(()=>[]);let O=-1;o.some((I,R)=>"*"===I&&(O=R,!0));for(let I=0,R=r.length;I<R;++I){const F=r[I],E=$(F,o,O);-1!==E&&f[E].push(F)}return f}(o,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(r,f,o),this.viewChangeDetectorRef=this.componentRef.injector.get(h.sBO),this.implementsOnChanges=function v(m){return"function"==typeof m}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(h.z2F).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:o,transform:r})=>{this.initialInputValues.has(o)&&this.setInputValue(o,this.initialInputValues.get(o),r)}),this.initialInputValues.clear()}initializeOutputs(o){const r=this.componentFactory.outputs.map(({propName:f,templateName:O})=>o.instance[f].pipe((0,a.U)(R=>({name:O,value:R}))));this.eventEmitters.next(r)}callNgOnChanges(o){if(!this.implementsOnChanges||null===this.inputChanges)return;const r=this.inputChanges;this.inputChanges=null,o.instance.ngOnChanges(r)}markViewForCheck(o){this.hasInputChanges&&(this.hasInputChanges=!1,o.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=c.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(o,r){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const f=this.inputChanges[o];if(f)return void(f.currentValue=r);const O=this.unchangedInputs.has(o),I=O?void 0:this.getInputValue(o);this.inputChanges[o]=new h.WD2(I,r,O)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(o){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(o):o()}}class n extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}var S=x(1386);let P=(()=>{class m{constructor(r){this.injector=r;const f=function l(m,o){const r=function D(m,o){return o.get(h._Vd).resolveComponentFactory(m).inputs}(m,o.injector),f=o.strategyFactory||new C(m,o.injector),O=function k(m){const o={};return m.forEach(({propName:r,templateName:f,transform:O})=>{o[function p(m){return m.replace(/[A-Z]/g,o=>`-${o.toLowerCase()}`)}(f)]=[r,O]}),o}(r);class I extends n{get ngElementStrategy(){if(!this._ngElementStrategy){const F=this._ngElementStrategy=f.create(this.injector||o.injector);r.forEach(({propName:E,transform:V})=>{if(!this.hasOwnProperty(E))return;const A=this[E];delete this[E],F.setInputValue(E,A,V)})}return this._ngElementStrategy}constructor(F){super(),this.injector=F}attributeChangedCallback(F,E,V,A){const[J,H]=O[F];this.ngElementStrategy.setInputValue(J,V,H)}connectedCallback(){let F=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),F=!0),this.ngElementStrategy.connect(this),F||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(F=>{const E=new CustomEvent(F.name,{detail:F.value});this.dispatchEvent(E)})}}return I.observedAttributes=Object.keys(O),r.forEach(({propName:R,transform:F})=>{Object.defineProperty(I.prototype,R,{get(){return this.ngElementStrategy.getInputValue(R)},set(E){this.ngElementStrategy.setInputValue(R,E,F)},configurable:!0,enumerable:!0})}),I}(M.J,{injector:this.injector});customElements.get("fe-custom-renderer")||customElements.define("fe-custom-renderer",f)}ngDoBoostrap(){}}return m.\u0275fac=function(r){return new(r||m)(h.LFG(h.zs3))},m.\u0275mod=h.oAB({type:m}),m.\u0275inj=h.cJS({providers:[S.x],imports:[e.ez]}),m})()},1386:(j,L,x)=>{x.d(L,{x:()=>M});var e=x(4769);let M=(()=>{class h{constructor(){this.canvas1=document.createElement("canvas"),this.canvas2=document.createElement("canvas"),this.ctx1=this.canvas1.getContext("2d"),this.ctx2=this.canvas2.getContext("2d"),this.width=0,this.height=0}color(g,y,s){const{x:d,y:a}=s.dimensions;this.setSize(d,a);const c=this.ctx1,p=this.ctx2;return p.clearRect(0,0,d,a),c.drawImage(g,0,0),p.globalCompositeOperation="source-over",p.drawImage(g,0,0),c.globalCompositeOperation="source-over",c.drawImage(g,0,0),this.overlayFilter(p,y),c.drawImage(this.canvas2,0,0),c.globalCompositeOperation="source-over",p.globalCompositeOperation="source-over",p.clearRect(0,0,255,255),this.canvas1}overlayFilter(g,y){const s=this.hexToRGBA(y),d=(u,v)=>{const w=u/255,b=v/255;return Math.round(255*(w<.5?2*w*b:1-2*(1-w)*(1-b)))},a=g.getImageData(0,0,256,256),c=u=>{a?.data&&(a.data[u]=d(a.data[u],s.r),a.data[u+1]=d(a.data[u+1],s.g),a.data[u+2]=d(a.data[u+2],s.b))},p=u=>0!=a.data[u+3];for(let u=0;u<a.data.length;u+=4)p(u)&&c(u);g.putImageData(a,0,0)}setSize(g,y){this.canvas1.width=g,this.canvas1.height=y,this.canvas2.width=g,this.canvas2.height=y,this.width=g,this.height=y}hexToRGBA(g,y=1){const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(g);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16),a:y}:null}}return h.\u0275fac=function(g){return new(g||h)},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},9340:(j,L,x)=>{x.d(L,{I:()=>M});var e=x(4769);let M=(()=>{class h{constructor(){}save(g,y){const s=document.createElement("a");s.download=y,s.href=g,s.click(),s.remove()}}return h.\u0275fac=function(g){return new(g||h)},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},8091:(j,L,x)=>{x.d(L,{D:()=>T});var e=x(7398),M=x(5619),h=x(4769);let T=(()=>{class g{constructor(){}getConfig(s){const d=this.generateImagePathConfig(s);return this.loadImagesFromLocal(d).pipe((0,e.U)(a=>{const c=a.loaded/a.count,p=a.images;if(p){const u=this.generateConfig(s.bodyOptions,{baseKey:s.rootKey,assets:p,menuOrder:s.menuOrder});return{complete:c,data:{dimensions:s.dimensions,options:u,menuOrder:s.menuOrder,layerOrder:s.layerOrder}}}return{complete:c,data:null}}))}loadImagesFromLocal(s){const d=[],a={},c=(v,w,b)=>{const B=w?`${w} ${b.name}`:b.name,Z=[v,b.path].join("/");if(b.subCategories?.length)for(const k of b.subCategories)c(Z,B,k);else d.push({key:B,path:Z})};c("",null,s);const p=new M.X({count:d.length,loaded:0,images:null});let u=0;return d.forEach(v=>{const w=new Image;w.addEventListener("load",()=>{a[v.key]=w,u++,u===d.length?(p.next({count:d.length,loaded:u,images:a}),p.complete()):p.next({count:d.length,loaded:u,images:null})}),w.src=v.path}),p.asObservable()}generateImagePathConfig(s){const{rootKey:d,rootPath:a,imageType:c,bodyOptions:p}=s;return{name:d,path:a,subCategories:Object.keys(p).map(v=>{const w=p[v],b=[],B=w.options;for(const k of Object.keys(w.options)){const D=B[k];this.doOnOptionType(D,()=>{b.push({name:k,path:`${D.path}.${c}`})},z=>{const $=this.getGeneralPaths(z,c);b.push({name:k,path:D.path,subCategories:$})},z=>{const i=this.getDependentPaths(B[z].count,D.childOptions,c);b.push({name:k,path:D.path,subCategories:i})})}return{name:v,path:w.path,subCategories:b}})}}getGeneralPaths(s,d){const a=[];for(let c=1;c<=s;c++)a.push({name:`${c}`,path:`${c}.${d}`});return a}getDependentPaths(s,d,a){const c=[];for(let p=1;p<=s;p++)Object.keys(d).forEach(u=>{c.push({name:`${p}_${u}`,path:`${p}_${d[u].path}.${a}`})});return c}generateConfig(s,d){return Object.keys(s).map(a=>({bodyType:a,title:s[a].title,config:this.generateConfigForBodyType(a,s[a],d)}))}generateConfigForBodyType(s,d,a){return a.menuOrder.map(c=>{const p=d.options,u=p[c];return this.doOnOptionType(u,()=>this.getToggleOptionConfig(s,c,u,a),v=>this.getStandardOptionConfig(s,c,u,a),v=>this.getDependentOptionConfig(s,c,u,v,p[v].count,a),()=>this.getNullOptionConfig(c))})}getToggleOptionConfig(s,d,a,c){const p=`${c.baseKey} ${s} ${d}`;return{...this.getConfigWithTitle(d,a),canBeBlank:!0,assets:c.assets[p]}}getStandardOptionConfig(s,d,a,c){const p=this.getConfigWithTitle(d,a),u=`${c.baseKey} ${s} ${p.name}`;return{...p,assets:this.getAssetsForType(u,a.count,c.assets)}}getNullOptionConfig(s){return{...this.getConfigWithTitle(s),assets:null}}getDependentOptionConfig(s,d,a,c,p,u){const v=this.getConfigWithTitle(d,a),w=`${u.baseKey} ${s} ${v.name}`,b=Object.keys(a.childOptions);return{...v,assets:this.getAssetsForType(w,p,u.assets,b),dependsOn:c}}getAssetsForType(s,d,a,c){if(!d)return null;const p=[];for(let u=1;u<=d;u++)if(c?.length){const v=c.map(w=>a[`${s} ${u}_${w}`]);p.push(v)}else p.push(a[`${s} ${u}`]);return p}getConfigWithTitle(s,d){if(!d)return{name:s,title:"--",offset:null,canBeBlank:!0,assets:null};const a={name:s,title:d.title,offset:d.offset,canBeBlank:d.canBeBlank||!1,colorSettings:d.colorSettings,assets:null};return d.childOptions?{...a,optionLabels:Object.values(d.childOptions).map(c=>c.title)}:{...a}}doOnOptionType(s,d,a,c,p){return s?.toggleable?d():s?.count?a(s.count):s?.dependsOn?c(s.dependsOn):p?p():void 0}}return g.\u0275fac=function(s){return new(s||g)},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},1241:(j,L,x)=>{x.d(L,{d:()=>M});var e=x(4769);let M=(()=>{class h{constructor(){this.configStore={}}getConfig(g){return this.configStore[g]}setConfig(g,y){this.configStore[g]=y}}return h.\u0275fac=function(g){return new(g||h)},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);